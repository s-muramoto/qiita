
## はじめに
今回は、量子コンピュータのアルゴリズムの1種として、「量子アニーリング」があるので、どういったものなのかをまず、紹介する。

## 量子コンピュータ
　量子力学の物理状態・性質を活用した高速計算が可能なコンピュータのこと。  
要は、以下のような人間が頭や手で計算することが到底困難な式の解を高速に導くことができるコンピュータ。

$\sum_{α, β}\sum_{i}d_{αβ}q_{αi}q_{β, i+1} + a\sum_{α}(\sum_{i}q_{αi} - 1)^2 + b\sum_{i}(\sum_{α}q_{αi} - 1)^2$


## 量子アニーリング
任意の最適化問題で取りうる局所解から、よりベストな解を探索するためのアルゴリズム。

## 定式化のコツ
ナップサック問題を例に説明する  
・目的: できるだけバッグに詰める品物の値段を最大としたい  
・制約条件: バッグに詰めれる品物の重さは、3000gまで  
・定式化に使うスピン($x_{*}$)は、QUBOモデル (1/0のバイナリ表現)  
・品物を詰める($x_{*}$=1), 品物を詰めない($x_{*}$=0)とする。

|  品物  |  値段 (円)  |  容量 (g)  |
| ---- | ---- | ---- |
|  金塊  |  12000  |  2500  |
|  壺  |  2500  |  800  |
|  指輪  |  100  |  30  |
|  ネックレス  |  200  |  50  |
|  現金  |  3000  |  600  |
|  置物  |  5000  |  1300  |
|  絵画  |  8500  |  1700  |
|  腕時計  |  700  |  250  |

### 定式化の例
・目的関数の数式例  
H1 = $-(12000x_{1} + 2500x_{2} + 100x_{3} + 200x_{4} + 3000x_{5} + 5000x_{6} + 8500x_{7} + 700x_{8})$  
→ 品物を詰めるほど、式の結果が最小になる。

・制約条件の数式例
H2 = $(3000 - (2500x_{1} + 800x_{2} + 30x_{3} + 50x_{4} + 600x_{5} + 1300x_{6} + 1700x_{7} + 250x_{8}))^2$
→ 品物の重量合計が3000gに近いほど、式の結果が最小になる。


## Pythonによる実行例
・事前にpyquboとdwace-ocean-sdkをインストールしておく。

```
from pyqubo import Array, Constraint
import neal

# ビット数
N = 8

# バッグの重量制限
limit_weight = 3000

# スピンの定義
x = Array.create('x', shape=N, vartype='BINARY')

# 目的関数 値段は最大になるようにする
H1 = - (12000*x[0] + 2500*x[1] + 100*x[2] + 200*x[3] + 3000*x[4] + 5000*x[5] + 8500*x[6] + 700*x[7])

# 制約条件 重量は3000gまで
H2 = Constraint((limit_weight - (2500*x[0] + 800*x[1] + 30*x[2] + 50*x[3] + 600*x[4] + 1300*x[5] + 1700*x[6] + 250*x[7]))**2, "const")
H = H1 + H2

# PyQUBOで、QUBOモデル作成
model = H.compile()
qubo, offset = model.to_qubo(feed_dict={"const": 1.0})

# dwaveのシミュレーション結果
sampler = neal.SimulatedAnnealingSampler()
result = sampler.sample_qubo(qubo)

```

・実行結果例  
最適解である値段合計=13500円, 容量合計=300g の解を量子アニーリングで
探索できていることが分かる。 (置物(x[5]), 絵画(x[6]))

```
x[0] x[1] x[2] x[3] x[4] x[5] x[6] x[7]        energy         num_oc.
  0    0    0    0    0    1    1     0 　　　-9013500.0        1
['BINARY', 1 rows, 1 samples, 8 variables]

```